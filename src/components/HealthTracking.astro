---
interface Props {
  t: {
    healthTracking: {
      badge: string;
      title: string;
      subtitle: string;
      categories: Array<{
        icon: string;
        title: string;
        description: string;
        count: number;
      }>;
      summary?: {
        label: string;
        description: string;
      };
      items?: Array<{
        icon: string;
        title: string;
        description: string;
      }>;
    };
  };
}

const { t } = Astro.props;

// Total indicators count
const totalIndicators = t.healthTracking.categories?.reduce((sum, cat) => sum + cat.count, 0) || 17;

// Category accent colors
const categoryColors = [
  { bg: 'from-blue-500/20 to-indigo-500/20', text: 'text-blue-400', border: 'border-blue-500/30' },
  { bg: 'from-cyan-500/20 to-teal-500/20', text: 'text-cyan-400', border: 'border-cyan-500/30' },
  { bg: 'from-pink-500/20 to-rose-500/20', text: 'text-pink-400', border: 'border-pink-500/30' },
  { bg: 'from-amber-500/20 to-orange-500/20', text: 'text-amber-400', border: 'border-amber-500/30' },
  { bg: 'from-green-500/20 to-emerald-500/20', text: 'text-green-400', border: 'border-green-500/30' },
  { bg: 'from-primary-orange/20 to-primary-red/20', text: 'text-primary-orange', border: 'border-primary-orange/30' },
  { bg: 'from-red-500/20 to-rose-500/20', text: 'text-red-400', border: 'border-red-500/30' },
  { bg: 'from-fuchsia-500/20 to-purple-500/20', text: 'text-fuchsia-400', border: 'border-fuchsia-500/30' },
  { bg: 'from-violet-500/20 to-indigo-500/20', text: 'text-violet-400', border: 'border-violet-500/30' },
  { bg: 'from-lime-500/20 to-green-500/20', text: 'text-lime-400', border: 'border-lime-500/30' },
];
---

<section id="health-tracking" class="py-12 md:py-16 relative overflow-hidden">
  <!-- Background -->
  <div class="absolute inset-0 bg-gradient-to-b from-dark-bg via-dark-surface/50 to-dark-bg"></div>
  <div class="absolute top-1/3 left-0 w-[500px] h-[500px] bg-primary-orange/5 rounded-full blur-[100px]"></div>
  <div class="absolute bottom-1/3 right-0 w-[400px] h-[400px] bg-blue-500/5 rounded-full blur-[100px]"></div>

  <div class="section-container relative z-10">
    <!-- Section header -->
    <div class="text-center max-w-3xl mx-auto mb-16">
      <div class="inline-flex items-center gap-2 px-4 py-2 bg-primary-orange/10 border border-primary-orange/20 rounded-full mb-6">
        <span class="material-symbols-outlined text-primary-orange">monitoring</span>
        <span class="text-primary-orange font-medium">{t.healthTracking.badge}</span>
      </div>
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold mb-4">
        {t.healthTracking.title}
      </h2>
      <p class="text-text-secondary text-lg">
        {t.healthTracking.subtitle}
      </p>
    </div>

    <!-- Categories list - Compact list for mobile, grid for desktop -->
    {t.healthTracking.categories && (
      <div class="space-y-3 sm:space-y-0 sm:grid sm:grid-cols-2 lg:grid-cols-3 sm:gap-5 lg:gap-6 mb-12">
        {t.healthTracking.categories.map((category, index) => {
          const colors = categoryColors[index % categoryColors.length];
          return (
            <div
              class={`group flex items-center gap-4 p-4 sm:p-6 sm:block bg-dark-surface border ${colors.border} rounded-xl sm:rounded-2xl hover:scale-[1.01] sm:hover:scale-[1.02] transition-all duration-300 overflow-hidden relative`}
            >
              <!-- Gradient accent on hover -->
              <div class={`absolute inset-0 bg-gradient-to-br ${colors.bg} opacity-0 group-hover:opacity-30 transition-opacity duration-300`}></div>

              <div class="relative z-10 flex items-center gap-4 sm:block">
                <!-- Icon - inline on mobile, block on desktop -->
                <div class={`w-12 h-12 sm:w-14 sm:h-14 flex-shrink-0 flex items-center justify-center bg-gradient-to-br ${colors.bg} rounded-xl sm:mb-4`}>
                  <span class={`material-symbols-outlined text-2xl sm:text-3xl ${colors.text}`}>{category.icon}</span>
                </div>

                <!-- Content -->
                <div class="flex-1 min-w-0">
                  <div class="flex items-center gap-2 sm:justify-between sm:mb-0">
                    <h3 class={`font-bold text-base sm:text-xl ${colors.text} truncate sm:whitespace-normal`}>
                      {category.title}
                    </h3>
                    <span class={`text-xs sm:text-sm px-2 py-0.5 sm:px-3 sm:py-1.5 rounded-full bg-gradient-to-br ${colors.bg} ${colors.text} font-bold flex-shrink-0`}>
                      {category.count}
                    </span>
                  </div>
                  <p class="text-text-secondary text-sm sm:text-base leading-relaxed mt-1 sm:mt-2 line-clamp-2 sm:line-clamp-none">
                    {category.description}
                  </p>
                </div>
              </div>
            </div>
          );
        })}
      </div>
    )}

    <!-- Fallback to old items if no categories -->
    {!t.healthTracking.categories && t.healthTracking.items && (
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {t.healthTracking.items.map((item, index) => (
          <div
            class="group p-6 bg-dark-surface/80 backdrop-blur border border-dark-border rounded-2xl hover:border-primary-orange/50 transition-all duration-300"
          >
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 flex items-center justify-center bg-gradient-to-br from-primary-orange/20 to-primary-red/20 rounded-xl group-hover:scale-110 transition-transform">
                <span class="material-symbols-outlined text-2xl text-primary-orange">{item.icon}</span>
              </div>
              <div class="flex-1">
                <h3 class="font-semibold text-lg mb-2 group-hover:text-primary-orange transition-colors">
                  {item.title}
                </h3>
                <p class="text-text-secondary text-sm leading-relaxed">
                  {item.description}
                </p>
              </div>
            </div>
          </div>
        ))}
      </div>
    )}

    <!-- Total indicator summary -->
    <div class="mt-12 flex justify-center px-4">
      <div class="inline-flex flex-col sm:flex-row items-center gap-4 px-6 sm:px-8 py-5 sm:py-4 bg-dark-surface border border-dark-border rounded-2xl">
        <div class="flex items-center gap-3">
          <div class="flex -space-x-1">
            <div class="w-4 h-4 sm:w-3 sm:h-3 bg-green-500 rounded-full animate-pulse"></div>
            <div class="w-4 h-4 sm:w-3 sm:h-3 bg-yellow-500 rounded-full animate-pulse" style="animation-delay: 200ms"></div>
            <div class="w-4 h-4 sm:w-3 sm:h-3 bg-primary-orange rounded-full animate-pulse" style="animation-delay: 400ms"></div>
          </div>
          <div class="text-center sm:text-left">
            <div class="text-3xl sm:text-2xl font-bold gradient-text">{totalIndicators}+</div>
            <div class="text-text-muted text-sm sm:text-xs">{t.healthTracking.summary?.label || 'indicators'}</div>
          </div>
        </div>
        <div class="hidden sm:block w-px h-8 bg-dark-border"></div>
        <span class="text-text-secondary text-base sm:text-sm text-center sm:text-left">{t.healthTracking.summary?.description || ''}</span>
      </div>
    </div>
  </div>
</section>
